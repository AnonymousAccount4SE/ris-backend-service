import{d as D,C as y,i as g,J as N,A as n,c as u,f as t,k as o,t as z,b as m,g as T,T as B,K as C,h as E,l as V,L,a as l}from"./index-cff6e716.js";import{d as c}from"./dayjs.min-633259b2.js";import{u as Y,t as j,a as A,b as F}from"./operations-a5ad7ae8.js";import{_ as M}from"./InfoModal.vue_vue_type_script_setup_true_lang-1bab6c8b.js";import{u as P}from"./loadedNorm-11b41e0b.js";const S={class:"max-w-screen-lg"},Z=t("div",null,[t("h1",{class:"heading-02-regular mb-[1rem]"},"Export"),t("p",null,"Exportieren Sie die Dokumentationseinheit zur Abgabe an die jDV.")],-1),H={class:"bg-white mt-[2rem] p-[2rem]"},R={class:"mb-32"},U=t("h2",{class:"heading-03-regular"},"Zip-Datei steht zum Download bereit.",-1),G={key:0,class:"body-01-reg"},I={class:"mt-[1rem]"},J=["onClick"],K={key:0,class:"align-middle material-icons ml-[0.5rem] text-20 text-blue-800"},ee=D({__name:"export",setup(O){c.extend(Y),c.extend(j);const f=P(),{loadedNorm:r}=y(f),i=g(!1),_=g(!1),h=N({title:"",description:""}),a=n(()=>{var s;const e=((s=r.value)==null?void 0:s.files)??[];return e.length>0?e[e.length-1]:void 0}),v=n(()=>{var e;return(e=a.value)==null?void 0:e.name}),p=n(()=>r.value&&a.value?A(r.value.guid,a.value.hash):void 0),b=n(()=>p.value!=null),k=function(e){return c.utc(e).tz(c.tz.guess()).format("DD.MM.YYYY HH:mm")};async function x(){var s;i.value=!0;const e=((s=r.value)==null?void 0:s.guid)||"";try{const d=await F(e);await new Promise(w=>setTimeout(w,300)),d.status===200&&d.data?await f.load(e):(Object.assign(h,d.error),_.value=!0)}finally{i.value=!1}}return(e,s)=>(l(),u("div",S,[Z,t("div",H,[t("div",R,[U,o(a)?(l(),u("p",G," zuletzt generiert am "+z(k(o(a).createdAt)),1)):m("",!0)]),T(B,{disabled:!o(b)||i.value,download:o(v),href:o(p),label:"Zip Datei speichern",target:"_blank"},null,8,["disabled","download","href"]),t("div",I,[t("a",{class:"link-01-bold underline",href:"#",onClick:C(x,["prevent"])},[E("Neue Zip-Datei generieren "),i.value?(l(),u("span",K," refresh ")):m("",!0)],8,J)])]),_.value?(l(),V(M,L({key:0},h,{class:"mt-8"}),null,16)):m("",!0)]))}});export{ee as default};
