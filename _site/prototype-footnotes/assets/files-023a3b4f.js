import{_ as D}from"./DocumentUnitWrapper.vue_vue_type_script_setup_true_lang-df966c6d.js";import{d as k}from"./dayjs.min-633259b2.js";import{s as _,T as F}from"./fileService-4269fc4b.js";import{d as g,i as p,A as y,z as N,a as i,c as f,f as m,F as T,r as $,g as h,k as c,T as M,l as w,b as C,w as S,X as A,j as B,t as b}from"./index-a85493d9.js";import{_ as E}from"./PopupModal.vue_vue_type_script_setup_true_lang-db4b6517.js";import{c as V}from"./SideToggle.vue_vue_type_script_setup_true_lang-72a653af.js";import{d as x}from"./documentUnitService-87110792.js";import{F as L}from"./FileUpload-1587b603.js";import"./InfoModal.vue_vue_type_script_setup_true_lang-ef45ccaf.js";import"./FileInput-ebf0cd0a.js";const Y={class:"flex flex-col gap-32 grow"},j={class:"bg-white flex flex-col items-start px-[2rem] py-[1.5rem]"},z={class:"flex pb-[1rem] w-full"},H=g({__name:"FileViewer",props:{s3Path:null,fileName:null,fileType:null,uploadTimeStamp:null},emits:["deleteFile"],setup(l){const n=l,o=p(!1),d=y(()=>`Möchten Sie die ausgewählte Datei ${n.fileName} wirklich löschen?`),r=y(()=>[{label:"Hochgeladen am",value:k(n.uploadTimeStamp).format("DD.MM.YYYY")},{label:"Format",value:n.fileType},{label:"Von",value:"USER NAME"},{label:"Dateiname",value:n.fileName}]),a=()=>{if(o.value=!o.value,o.value){const e=document.documentElement.scrollLeft,t=document.documentElement.scrollTop;window.onscroll=()=>{window.scrollTo(e,t)}}else window.onscroll=()=>{}},u=p("Dokument wird geladen.");return N(async()=>{const e=await _.getDocxFileAsHtml(n.s3Path);e.error?console.error(e.error):u.value=e.data}),(e,t)=>(i(),f("div",Y,[m("div",j,[m("div",z,[(i(!0),f(T,null,$(c(r),s=>(i(),f("div",{key:s.label,class:"grow"},[h(V,{direction:"column",label:s.label,value:s.value},null,8,["label","value"])]))),128))]),h(M,{icon:"delete",label:"Datei löschen",onClick:a})]),h(F,{class:"bg-white grow","field-size":"max",value:u.value},null,8,["value"]),o.value?(i(),w(E,{key:0,"aria-label":"Dokument löschen","cancel-button-type":"ghost","confirm-button-type":"secondary","confirm-text":"Löschen","content-text":c(d),onCloseModal:a,onConfirmAction:t[0]||(t[0]=s=>(a(),e.$emit("deleteFile")))},null,8,["content-text"])):C("",!0)]))}}),R=m("h1",{class:"heading-02-regular mb-[1rem]"},"Dokumente",-1),O={key:1,class:"flex flex-col items-start w-[40rem]"},P=m("div",{class:"mb-14"}," Aktuell ist keine Datei hinterlegt. Wählen Sie die Datei des Originaldokumentes aus ",-1),I=g({__name:"DocumentUnitFiles",props:{documentUnit:null},emits:["updateDocumentUnit"],setup(l,{emit:n}){const o=l,d=p(),r=p(!1);async function a(){if((await _.delete(o.documentUnit.uuid)).status<300){const e=await x.getByDocumentNumber(o.documentUnit.documentNumber);e.error?console.error(e.error):n("updateDocumentUnit",e.data)}}async function u(e){r.value=!0;try{const t=await _.upload(o.documentUnit.uuid,e);t.status===201&&t.data?n("updateDocumentUnit",t.data):d.value=t.error}finally{r.value=!1}}return(e,t)=>(i(),w(D,{"document-unit":l.documentUnit},{default:S(({classes:s})=>[m("div",{class:A(["flex flex-col",s])},[R,l.documentUnit.hasFile?(i(),w(H,{key:0,"file-name":l.documentUnit.filename,"file-type":l.documentUnit.filetype,"s3-path":l.documentUnit.s3path,"upload-time-stamp":l.documentUnit.fileuploadtimestamp,onDeleteFile:a},null,8,["file-name","file-type","s3-path","upload-time-stamp"])):(i(),f("div",O,[P,h(L,{error:d.value,"is-loading":r.value,onFileSelected:t[0]||(t[0]=v=>u(v))},null,8,["error","is-loading"])]))],2)]),_:1},8,["document-unit"]))}}),W={key:1},le=g({__name:"files",props:{documentNumber:null},async setup(l){let n,o;const d=l;async function r(){const e=await x.getByDocumentNumber(d.documentNumber);return{documentUnit:p(e.data),error:e.error}}const{documentUnit:a,error:u}=([n,o]=B(()=>r()),n=await n,o(),n);return(e,t)=>{var s,v;return c(a)?(i(),w(I,{key:0,"document-unit":c(a),onUpdateDocumentUnit:t[0]||(t[0]=U=>Object.assign(c(a),U))},null,8,["document-unit"])):(i(),f("div",W,[m("h2",null,b((s=c(u))==null?void 0:s.title),1),m("p",null,b((v=c(u))==null?void 0:v.description),1)]))}}});export{le as default};
